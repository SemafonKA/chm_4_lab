# Практическая работа №4 по предмету "Численные методы"

Вариант 1,2,6.

## Содержание:

- [Практическая работа №4 по предмету "Численные методы"](#практическая-работа-4-по-предмету-численные-методы)
  - [Содержание:](#содержание)
  - [1. Немного теории](#1-немного-теории)
    - [1.1 Чем мы тут вообще занимаемся?](#11-чем-мы-тут-вообще-занимаемся)
    - [1.2 Если грубо, то что делает метод?](#12-если-грубо-то-что-делает-метод)
  - [2. Метод Ньютона](#2-метод-ньютона)
  - [3. Графика](#3-графика)

---

## 1. Немного теории

### 1.1 Чем мы тут вообще занимаемся?

Почему-то именно этот вопрос я слышал наиболее часто. Так вот, нам дана система вида:

$$\begin{cases} 
    F_1(x_1, x_2, \cdots, x_n) & = 0 \\
    F_2(x_1, x_2, \cdots, x_n) & = 0 \\
    \vdots                           \\
    F_m(x_1, x_2, \cdots, x_n) & = 0
\end{cases}$$

Наша цель: найти такие значения $x = (x_1, x_2, \cdots, x_n)$, чтобы система уравнений была верна либо максимально близка к верному решению.

При этом, функции могут иметь любой вид, никто не мешает одновременно задать две окружности и две прямые.

Если представить эту систему в виде вектора $F = (F_1(x), F_2(x), \cdots, F_m(x))$, то тогда можно сформулировать задачу следующим образом: необходимо найти такое значение $x$, чтобы $||F||$ была минимальной.

### 1.2 Если грубо, то что делает метод?

Если грубо, то метод Ньютона находит точки пересечения заданных функций. В двумерном случае, это может быть, например, точкой пересечения двух окружностей.

Если точки пересечения нет, то метод должен найти какую-либо такую точку, чтобы $||F||$ была минимальной (можно сказать, найти такую точку, в которой все функции будут иметь наимешьнее значение).

Если точек пересечения несколько, то, если метод находится ровно посередине между ними, скорее всего он застрянет и не сможет сдвинуться никуда. Происходит это из-за особенностей работы самого метода. В примере с окружностями, метод всегда будет двигаться по касательной к ближайшей окружности. Из-за этого в некоторых ситуациях может выйти так, что движение метода в любую из сторон по касательной будет лишь увеличивать погрешность, и он застрянет. Чтобы заставить его двигаться, нужно переместить начальное приближение в другую сторону.

---

## 2. Метод Ньютона

За решение систем отвечает модуль `NewtonsSolver`. Инициализация метода довольно простая, достаточно лишь передать в него число переменных, функций, а также функцию с функциями и функцию с их производными. 

Основные модули метода Ньютона:

- `Matrix` - плотные матрицы, используются при формировании матрицы Якоби (возможно можно было сразу генерировать разреженные матрицы Якоби, но мне лень);
- `ProfileMatrix` - разреженные матрицы в профильном формате, есть удобный генератор матриц из плотных матриц `Matrix`. Помимо прочего, такие матрицы умеют раскладывать сами себя в LU-формат, не затрачивая лишнюю память;
- `ProfileLU` - статический класс для LU-решения матриц `ProfileMatrix` в LU-приведённом виде;
- `NewtonsSolver` - собственно сам модуль для решения систем нелинейных уравнений методом Ньютона.

## 3. Графика

Графика сделана только для двумерных задач и выполнена  на основе библиотеки [SFML 2.5.1](https://github.com/SFML/SFML). Все необходимые файлы библиотеки SFML включены в проект.

Для отображения текста, был использован шрифт "Kelvinch-Roman", также находящийся в папке проекта.

Основной модуль для вывода графики: `GraphicDrawer`.

Косяки, требующие переделки:

- [ ] Низкая производительность отрисовки графиков (в идеале переделать раскраску тепловой карты в шейдеры);
- [ ] Центр осей координат всегда в центре экрана, не для всех функций это удобно;
- [ ] Масштаб по осям X и Y одинаковый и меняется одновременно;
- [ ] После отрисовки осей координат, начальная и конечная точки, а также траектория движения метода отрисовываются без цвета, в чб варианте (приводит к тому, что иногда траектория движения сливается с осями координат);
- [ ] Метод отрисовки функций оставляет желать лучшего - толщина фигур сильно зависит от масштаба и от вида самих функций.

